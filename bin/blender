#!/usr/bin/env ruby

require File.expand_path(File.join(__FILE__, "../../lib/blender"))
include Blender

# commands are just ruby scripts in lib/blender/cli
COMMANDS_DIR = File.expand_path("lib/blender/cli", Blender::ROOT)
COMMANDS = Dir["#{COMMANDS_DIR}/*rb"].map {|f| File.basename(f).split(".").first}

command = ARGV.shift
unless command && COMMANDS.include?(command)
  abort <<-USAGE
Usage: blender COMMAND [OPTIONS]

Available commands: #{COMMANDS * " "}
Run "blender COMMAND -h" to get help about a command
  USAGE
end

require 'optparse'
require File.expand_path(File.join(__FILE__, "../../lib/blender/cli/", command))
command.classify.constantize.new(ARGV).execute